XRUTA = fp_leerdsn('DSN.TXT')

XCURSOR = 'PROVE_COMPIER_1'
wait window 'Conectando ' nowait
close databases all



PRG_OPENCONNE_SERVER_NEW(XRUTA)

close databases all

A = "Select  CBP.C_BPartner_ID,CBP.Value AS PROVEEDOR_A ,CBP.Name AS NOMBRE ,CBP.TaxID RIF ,CBPL.PHONE AS TLF , "
B = "CBPL.FAX AS FAX ,CL.Address1 AS DIRECF ,CL.Address2 AS DIRECF2 ,CL.Address3 AS DIRECF3 , CL.Address4 AS DIRECF4 ,CL.CITY AS CITY,"
C = "CBPB.A_Email AS EMAIL,CPAY.NETDAYS AS CONDICION,CBP.ISVENDOR AS ESPROVEEDOR, "
D = "CBP.ISCUSTOMER AS ESCLIENTE,CBP.ISEMPLOYEE AS ESEMPLEADO,CBP.ISACTIVE, "
E = "CBP.ISTAXEXEMPT AS ISEXENTO,CBP.C_BP_group_id,CBP.xx_tipopersona_id,XX_TIPOP.DESCRIPTION AS tipo_perso,  "
f = "CBPB.C_BP_BANKACCOUNT_ID AS COD_BAN ,CBPB.C_BANK_ID,CBPB.ACCOUNTNO AS CUENTA,CBANK.NAME AS BANCO,CBANK.SWIFTCODE AS ABA ,CBANK.SWIFTCODE AS SWIFT, cbp.xx_retencion_iva_id,XX_ret_iva.monto_retener AS monto_rete,"
G = "C_ELEMENT.VALUE AS CXP , CBPvendor.V_PREPAYMENT_ACCT , CBPB.A_IDENT_DL AS RIF_PAGO , CBPvendor.V_LIABILITY_ACCT AS ID_CTA,CBPvendor.V_LIABILITY_SERVICES_ACCT AS SERVI_ID, CBPvendor.V_PREPAYMENT_ACCT AS CTA_ANTICI_ID,CBP.RETENTIONLETTERHAS AS LETTERETEN "
H = " From C_BPartner CBP LEFT Join C_Bpartner_Location CBPL On CBP.C_BPartner_ID = CBPL.C_BPartner_ID "
I = "LEFT Join C_Location CL On CL.C_LOCATION_ID =CBPL.C_LOCATION_ID "
J = "Left Join C_BP_BankAccount CBPB On CBP.C_BPartner_ID = CBPB.C_BPartner_ID "
K = "LEFT JOIN c_paymentterm CPAY ON CBP.PO_paymentterm_id = CPAY.C_paymentterm_id "
L = "LEFT JOIN C_BP_vendor_acct CBPvendor ON CBP.C_BPartner_ID = CBPvendor.C_BPartner_ID "
M = "LEFT JOIN C_VALIDCOMBINATION CVCOMB ON CBPvendor.V_LIABILITY_ACCT = CVCOMB.C_VALIDCOMBINATION_ID "
n = "LEFT JOIN C_ELEMENTVALUE C_ELEMENT ON CVCOMB.ACCOUNT_ID = C_ELEMENT.C_ELEMENTVALUE_ID "
O = "LEFT JOIN xx_tipopersona XX_TIPOP ON CBP.xx_tipopersona_id = XX_TIPOP.xx_tipopersona_ID  LEFT JOIN xx_retencion_iva XX_ret_iva ON CBP.xx_retencion_iva_id = XX_ret_iva.xx_retencion_iva_ID "

P = "Left Join C_Bank CBANK On CBPB.C_BANK_ID = CBANK.C_BANK_ID "

Q = "WHERE CBP.AD_CLIENT_ID = 1000000 AND CBP.AD_ORG_ID = 1000000 "
*Q ="WHERE CBP.AD_CLIENT_ID = 1000000 AND CBP.AD_ORG_ID = 1000000 AND CBP.Value = '1046'"
R = "Order By CBP.Value "

XSQL = A+B+C+D+E+f+G+H+I+J+K+L+M+n+O+P+Q+R
*XSQL = ' SELECT * FROM xx_retencion_iva '

xresul =  PRG_OPENTABLE_NEW(XCURSOR,XSQL)


SELECT XCURSOR
BROWSE 


if xresul =.f.
	wait window 'ERROR DE CONEXION'

	return
endif
